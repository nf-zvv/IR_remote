# Инфракрасный приемопередатчик

Ожидает получения команды по ИК порту по протоколу NEC и отправляет адрес и команду по UART. При получении данных по UART, они отправляются по ИК каналу.

## Подготовка окружения

Для компиляции программ на языке C для микроконтроллеров AVR используется AVR GCC toolchain.

1. Тулчейн AVR GCC для Windows можно скачать, например, [здесь](https://blog.zakkemble.net/avr-gcc-builds/) ([GitHub](https://github.com/ZakKemble/avr-gcc-build/releases)).
2. Тулчейн необходимо распаковать в директорию `c:\avr-gcc`. 
3. Добавить директорию `c:\avr-gcc\bin` в переменную среды `path`.
4. Склонировать себе этот репозиторий.

Исходники проекта хранятся в папке `src`. Заголовочные файлы в `inc`. Скомпилированные файлы будут лежать в папке `build`.

## Сборка проекта и прошивка микроконтроллера

Для сборки проекта необходимо во встроенном терминале VSCODE (Ctrl+Shift+\`) выполнить команду 

```
make
```

В результате в папке `buld` будут созданы следующие файлы: сама прошивка `.hex`, EEPROM `.epp`, ассемблерный листинг `.lss`.

Для прошивки микроконтроллера испольуется следующая команда:

```
make prog
```

> [!NOTE]
> Перед выполнением данной команды необходимо указать правильный порт программатора Avrdude, к которому подключена плата arduino. См. опцию `PORT` в файле `Makefile`.

> [!NOTE]
> При добавлении новых исходных файлов в `Makefile` в переменную `C_SOURCES` добавить используемые `*.c` файлы.

Другие цели сборки:

- `make read_eeprom` - считает содержимое EEPROM памяти микроконтроллера;
- `make write_eeprom` - запишет память EEPROM микроконтроллера;
- `make size` - покажет размер прошивки;
- `make analyze` - анализ структуры пришивки;
- `make clean` - очистка.
